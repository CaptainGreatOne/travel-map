---
phase: 09-admin-search-sort
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [src/components/admin/LocationManager.jsx]
autonomous: true
---

<objective>
Add search, category filter, and sortable columns to LocationManager for efficient admin navigation.

Purpose: Enable admin to quickly find and manage locations in a growing list (600+ expected).
Output: LocationManager with search bar, category dropdown, and clickable sort headers.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@src/components/admin/LocationManager.jsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add search input for location name filtering</name>
  <files>src/components/admin/LocationManager.jsx</files>
  <action>
Add search functionality to filter locations by name:

1. Add state: `const [searchQuery, setSearchQuery] = useState('');`

2. Add search input above the table (next to existing country filter):
   - Text input with placeholder "Search locations..."
   - Use existing Tailwind input styling pattern from country filter select
   - Add search icon from lucide-react (Search) if desired, or keep it simple

3. Update filteredLocations to also filter by search query:
   - Filter by name (case-insensitive includes)
   - Apply search filter in combination with existing country filter
   - Example: `locations.filter(loc => loc.name.toLowerCase().includes(searchQuery.toLowerCase()))`

4. Update the "Showing X of Y locations" text to reflect combined filters
  </action>
  <verify>npm run build succeeds</verify>
  <done>Search input filters locations by name, works with country filter</done>
</task>

<task type="auto">
  <name>Task 2: Add category filter dropdown</name>
  <files>src/components/admin/LocationManager.jsx</files>
  <action>
Add category filter dropdown (similar to existing country filter):

1. Add state: `const [categoryFilter, setCategoryFilter] = useState('');`

2. Add category dropdown next to country filter:
   - Use same styling as country filter select
   - Options: "All Categories" (value="") plus all categories from categories state
   - Display category icon + name in options

3. Update filteredLocations to also filter by category:
   - Filter by category_id matching selected category
   - Apply in combination with search and country filters

4. Arrange filters in a row: Search input | Category dropdown | Country dropdown
   - Use flex with gap for spacing
  </action>
  <verify>npm run build succeeds</verify>
  <done>Category dropdown filters locations, combines with search and country filters</done>
</task>

<task type="auto">
  <name>Task 3: Add sortable column headers</name>
  <files>src/components/admin/LocationManager.jsx</files>
  <action>
Make Name and Visited columns sortable:

1. Add state for sorting:
   ```javascript
   const [sortField, setSortField] = useState('name'); // 'name' or 'date_visited'
   const [sortDirection, setSortDirection] = useState('asc'); // 'asc' or 'desc'
   ```

2. Create sort handler function:
   ```javascript
   function handleSort(field) {
     if (sortField === field) {
       setSortDirection(prev => prev === 'asc' ? 'desc' : 'asc');
     } else {
       setSortField(field);
       setSortDirection('asc');
     }
   }
   ```

3. Apply sorting to filteredLocations (after filtering):
   - Sort by name: localeCompare for alphabetical
   - Sort by date_visited: date comparison (nulls last)
   - Use useMemo for sorted list to avoid re-sorting on every render

4. Update table headers for Name and Visited:
   - Make headers clickable (cursor-pointer)
   - Add sort indicator (▲/▼ or ChevronUp/ChevronDown from lucide-react)
   - Show indicator only on active sort column
   - Use hover styling to indicate clickability

Header example:
```jsx
<th
  className="px-4 py-3 text-left text-sm font-medium text-gray-500 cursor-pointer hover:text-gray-700"
  onClick={() => handleSort('name')}
>
  Name {sortField === 'name' && (sortDirection === 'asc' ? '▲' : '▼')}
</th>
```
  </action>
  <verify>npm run build succeeds</verify>
  <done>Name and Visited columns are sortable with visual indicators</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] npm run build succeeds
- [ ] Search input filters locations by name (case-insensitive)
- [ ] Category dropdown filters by category
- [ ] Country dropdown still works (existing functionality)
- [ ] All filters combine correctly
- [ ] Name column is sortable (click toggles asc/desc)
- [ ] Visited column is sortable (click toggles asc/desc)
- [ ] Sort indicators show current sort state
</verification>

<success_criteria>
- All tasks completed
- Admin can search locations by name
- Admin can filter by category and country
- Admin can sort by name or visit date
- Filters and sort work together
</success_criteria>

<output>
After completion, create `.planning/phases/09-admin-search-sort/09-01-SUMMARY.md`
</output>
