---
phase: 05-admin-panel
plan: 02
type: execute
wave: 2
depends_on: ["05-01"]
files_modified: [src/pages/AdminPage.jsx, src/App.jsx, src/components/Sidebar.jsx]
autonomous: true
---

<objective>
Create the Admin page with route and dashboard metrics display.

Purpose: Establish the admin page structure and show key metrics at a glance.
Output: AdminPage accessible at /admin with metrics dashboard.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-admin-panel/05-01-SUMMARY.md

@src/App.jsx
@src/components/AdminGuard.jsx
@src/services/adminService.js
@src/pages/MapPage.jsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create AdminPage with dashboard metrics</name>
  <files>src/pages/AdminPage.jsx</files>
  <action>
Create `src/pages/AdminPage.jsx` with:

1. **Page structure:**
   - Title: "Admin Dashboard"
   - Metrics cards at top
   - Tab navigation for sections (Dashboard, Locations, Suggestions, Videos)
   - Content area that changes based on active tab

2. **Dashboard tab (default):**
   - Fetch metrics using `fetchDashboardMetrics()` from adminService
   - Display 3 cards:
     - Total Locations (count)
     - Pending Suggestions (count, highlight if > 0)
     - Total Reminders (count)
   - Loading state while fetching
   - Error state if fetch fails

3. **Tab state:**
   - useState for activeTab: 'dashboard' | 'locations' | 'suggestions' | 'videos'
   - Render placeholder divs for other tabs (will be replaced in later plans):
     ```jsx
     {activeTab === 'locations' && <div>Location management coming soon...</div>}
     {activeTab === 'suggestions' && <div>Suggestion moderation coming soon...</div>}
     {activeTab === 'videos' && <div>Video management coming soon...</div>}
     ```

4. **Styling (Tailwind):**
   - Max width container (max-w-6xl mx-auto)
   - Padding for content area
   - Cards with shadow, rounded corners
   - Tab buttons with active state styling
   - Responsive: stack cards on mobile, grid on desktop

Pattern for metrics cards:
```jsx
<div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
  <div className="bg-white p-6 rounded-lg shadow">
    <h3 className="text-gray-500 text-sm font-medium">Total Locations</h3>
    <p className="text-3xl font-bold text-secondary">{metrics.totalLocations}</p>
  </div>
  {/* ... more cards */}
</div>
```
  </action>
  <verify>File exists with metrics fetching: `grep -l "fetchDashboardMetrics" src/pages/AdminPage.jsx`</verify>
  <done>AdminPage created with dashboard metrics and tab navigation</done>
</task>

<task type="auto">
  <name>Task 2: Add /admin route with AdminGuard</name>
  <files>src/App.jsx, src/components/Sidebar.jsx</files>
  <action>
**In src/App.jsx:**

1. Import AdminPage and AdminGuard:
   ```jsx
   import AdminPage from './pages/AdminPage';
   import AdminGuard from './components/AdminGuard';
   ```

2. Add route inside Routes (before the catch-all):
   ```jsx
   {/* Admin page - protected by AdminGuard */}
   <Route path="/admin" element={
     <Layout>
       <AdminGuard>
         <AdminPage />
       </AdminGuard>
     </Layout>
   } />
   ```

3. Update getCurrentView() to handle admin:
   ```jsx
   if (path === '/admin') return 'admin';
   ```

**In src/components/Sidebar.jsx:**

1. Add admin to the navigation (only visible to admins):
   - Import useAuth if not already
   - Check if user email is in admin list
   - Conditionally render admin nav item at bottom of nav list
   - Use Settings or Shield icon from lucide-react

Pattern:
```jsx
// At component level, check admin status
const adminEmails = (import.meta.env.VITE_ADMIN_EMAILS || '').split(',').map(e => e.trim().toLowerCase());
const isAdmin = user && adminEmails.includes(user.email?.toLowerCase());

// In nav items, add conditionally:
{isAdmin && (
  <NavButton view="admin" icon={Settings} label="Admin" />
)}
```

Also add 'admin' to the routes object in LayoutContent (App.jsx):
```jsx
const routes = {
  map: '/',
  photography: '/photography',
  about: '/about',
  suggest: '/suggest',
  admin: '/admin'
};
```
  </action>
  <verify>Route exists: `grep -l '"/admin"' src/App.jsx` returns match</verify>
  <done>Admin route added with AdminGuard protection, sidebar shows admin link for admins</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] AdminPage.jsx exists with metrics dashboard
- [ ] /admin route added to App.jsx wrapped in AdminGuard
- [ ] Sidebar shows Admin link only for admin users
- [ ] Tab navigation structure ready for location/suggestion/video managers
</verification>

<success_criteria>

- All tasks completed
- Admin page accessible at /admin
- Non-admins see "Access Denied"
- Dashboard displays metrics (locations, suggestions, reminders counts)
- Tab navigation ready for future components
</success_criteria>

<output>
After completion, create `.planning/phases/05-admin-panel/05-02-SUMMARY.md`
</output>
