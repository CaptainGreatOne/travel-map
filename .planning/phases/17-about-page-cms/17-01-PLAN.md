---
phase: 17-about-page-cms
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [supabase/migrations/012_about_content_table.sql, src/services/aboutService.js]
autonomous: true
---

<objective>
Create database table and service layer for About page content management.

Purpose: Enable admin to edit About page content (bio, video, social links) without code changes.
Output: about_content table with single-row pattern, aboutService with fetch/update operations.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/16-photography-page-cms/16-01-SUMMARY.md

@src/pages/AboutPage.jsx
@src/services/photoService.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create about_content database table</name>
  <files>supabase/migrations/012_about_content_table.sql</files>
  <action>
Create migration for about_content table with single-row pattern:

```sql
-- About page content (single row table)
CREATE TABLE IF NOT EXISTS about_content (
  id INTEGER PRIMARY KEY DEFAULT 1 CHECK (id = 1),
  youtube_video_id TEXT,
  bio_paragraph_1 TEXT,
  bio_paragraph_2 TEXT,
  bio_paragraph_3 TEXT,
  youtube_url TEXT,
  instagram_url TEXT,
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- RLS policies
ALTER TABLE about_content ENABLE ROW LEVEL SECURITY;

-- Public read access
CREATE POLICY "About content is publicly viewable"
  ON about_content FOR SELECT
  USING (true);

-- Authenticated users can update
CREATE POLICY "about_content_auth_update" ON about_content
  FOR UPDATE
  USING (auth.role() = 'authenticated');

-- Seed with current hardcoded values
INSERT INTO about_content (
  youtube_video_id,
  bio_paragraph_1,
  bio_paragraph_2,
  bio_paragraph_3,
  youtube_url,
  instagram_url
) VALUES (
  'YOUR_VIDEO_ID',
  'Hi, I''m A BITCHIN MOOSE! I''m a travel enthusiast documenting my adventures around the globe. This interactive map showcases over 600 locations I''ve either visited or dream of exploring.',
  'Through my YouTube channel, I share travel vlogs, guides, and tips to help you plan your own adventures. Each video is linked to specific locations on the map, making it easy to discover places and learn from my experiences.',
  'Whether you''re planning your next trip or just dreaming about future destinations, I hope this map inspires you to explore the world!',
  'https://youtube.com/@yourchannel',
  'https://instagram.com/capt_gr8_1'
) ON CONFLICT (id) DO NOTHING;
```

Key decisions:
- Single-row pattern with `id = 1` constraint prevents multiple rows
- Separate paragraph fields (not JSON array) for simple form binding
- Seed includes current placeholder values so page works immediately
  </action>
  <verify>Migration file exists with valid SQL syntax</verify>
  <done>about_content table migration created with single-row constraint and seed data</done>
</task>

<task type="auto">
  <name>Task 2: Create aboutService.js</name>
  <files>src/services/aboutService.js</files>
  <action>
Create service following established patterns from photoService.js:

```javascript
import { supabase } from '../utils/supabaseClient';

/**
 * Fetch about page content
 * @returns {Promise<Object|null>} About content or null on error
 */
export async function fetchAboutContent() {
  const { data, error } = await supabase
    .from('about_content')
    .select('*')
    .single();

  if (error) {
    console.error('Error fetching about content:', error);
    return null;
  }

  return data;
}

/**
 * Update about page content
 * @param {Object} updates - Fields to update
 * @returns {Promise<{success: boolean, data?: Object, error?: string}>}
 */
export async function updateAboutContent(updates) {
  const { data, error } = await supabase
    .from('about_content')
    .update({ ...updates, updated_at: new Date().toISOString() })
    .eq('id', 1)
    .select()
    .single();

  if (error) {
    console.error('Error updating about content:', error);
    return { success: false, error: 'Failed to update content' };
  }

  return { success: true, data };
}
```

Patterns:
- fetchAboutContent returns null on error (consistent with other fetch functions)
- updateAboutContent returns { success, data, error } (consistent with mutation functions)
- Uses `.single()` since we know there's exactly one row
  </action>
  <verify>npm run build succeeds</verify>
  <done>aboutService.js created with fetch and update functions following established patterns</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Migration file has valid SQL
- [ ] `npm run build` succeeds
- [ ] aboutService exports fetchAboutContent and updateAboutContent
</verification>

<success_criteria>
- All tasks completed
- Single-row table pattern with constraint
- Service layer follows established patterns
</success_criteria>

<output>
After completion, create `.planning/phases/17-about-page-cms/17-01-SUMMARY.md`
</output>
