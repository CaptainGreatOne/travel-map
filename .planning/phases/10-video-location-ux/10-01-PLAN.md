---
phase: 10-video-location-ux
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/admin/VideoManager.jsx
  - src/components/admin/SearchableLocationSelect.jsx
autonomous: true
---

<objective>
Create a searchable, filterable location selector for video-location linking in the admin panel.

Purpose: Improve admin UX when linking videos to locations - current simple dropdown is hard to use with many locations.
Output: SearchableLocationSelect component with search, visited-only filter, and multi-select capability.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@src/components/admin/VideoManager.jsx
@src/services/locationService.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SearchableLocationSelect component</name>
  <files>src/components/admin/SearchableLocationSelect.jsx</files>
  <action>
Create a reusable searchable dropdown component for selecting locations:

1. Props:
   - `locations` - array of location objects
   - `selectedIds` - array of currently selected location IDs (for multi-select)
   - `onSelect` - callback when a location is selected
   - `excludeIds` - array of IDs to exclude (already linked)
   - `placeholder` - input placeholder text
   - `multiSelect` - boolean, default false

2. Features:
   - Text input for filtering locations by name (case-insensitive)
   - "Visited only" checkbox filter to show only has_visited=true locations
   - Dropdown list below input showing matching locations
   - Show location category icon and country alongside name
   - Clear button to reset search
   - When multiSelect=true, show checkboxes and allow multiple selection
   - Show count of filtered results

3. UX:
   - Dropdown opens on focus/click
   - Dropdown closes on blur (with delay for click handling)
   - Keyboard: Enter selects highlighted, Escape closes
   - Highlight matching text in results
   - Max height with scroll for long lists (max-h-60 overflow-y-auto)

4. Styling:
   - Use existing Tailwind patterns from VideoManager
   - Border, rounded corners, focus ring
   - Hover highlight on options
   - Disabled state for excluded items (grayed out, non-clickable)
  </action>
  <verify>Component file exists and exports SearchableLocationSelect</verify>
  <done>SearchableLocationSelect component created with search, visited filter, multi-select support</done>
</task>

<task type="auto">
  <name>Task 2: Integrate SearchableLocationSelect into VideoManager</name>
  <files>src/components/admin/VideoManager.jsx</files>
  <action>
Replace the simple select dropdown in the "Link to Location" modal with SearchableLocationSelect:

1. Import SearchableLocationSelect from './SearchableLocationSelect'

2. In the Link to Location modal:
   - Replace the `<select>` with `<SearchableLocationSelect>`
   - Pass locations array
   - Pass excludeIds as location IDs already linked to this video (from video.location_videos)
   - Handle selection via onSelect callback

3. The modal should still work the same way:
   - User clicks "Link to Location" on a video card
   - Modal opens with SearchableLocationSelect
   - User searches/filters and selects a location
   - User clicks "Link Video" button
   - handleLinkToLocation is called with selected location

4. Keep multiSelect=false for now (single location selection per link action)
  </action>
  <verify>npm run dev - Link to Location modal shows searchable dropdown instead of simple select</verify>
  <done>VideoManager uses SearchableLocationSelect for location linking with search and visited filter</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] SearchableLocationSelect component exists in src/components/admin/
- [ ] Component filters locations by search text
- [ ] "Visited only" checkbox filters to visited locations
- [ ] VideoManager Link modal uses the new component
- [ ] Linking a video to location still works end-to-end
- [ ] npm run build succeeds
</verification>

<success_criteria>

- SearchableLocationSelect created with search and filter functionality
- VideoManager updated to use new component
- No regressions in video-location linking
- Build passes without errors
</success_criteria>

<output>
After completion, create `.planning/phases/10-video-location-ux/10-01-SUMMARY.md`
</output>
