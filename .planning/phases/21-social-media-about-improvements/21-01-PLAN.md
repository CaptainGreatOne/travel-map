---
phase: 21-social-media-about-improvements
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [src/components/admin/AboutEditor.jsx, src/pages/AboutPage.jsx, src/components/InstagramFeed.jsx, supabase/migrations/015_social_links_and_youtube_url.sql]
autonomous: true
---

<objective>
Improve the About page social media integration with full YouTube URL support, dynamic social media buttons, and fix the location count display bug.

Purpose: Enable admin to paste full YouTube URLs, manage social media platforms dynamically, simplify Instagram widget options, and ensure location count displays correctly when set.
Output: Updated AboutEditor with improved form fields, AboutPage with dynamic social buttons, and fixed stats display.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@src/components/admin/AboutEditor.jsx
@src/pages/AboutPage.jsx
@src/components/InstagramFeed.jsx
@src/services/aboutService.js
@supabase/migrations/012_about_content_table.sql
@supabase/migrations/014_about_content_stats.sql
</context>

<tasks>

<task type="auto">
  <name>Task 1: Accept full YouTube video URLs</name>
  <files>src/components/admin/AboutEditor.jsx</files>
  <action>
  1. Update the "YouTube Video ID" label to "YouTube Video URL or ID"
  2. Update placeholder to "e.g., https://youtube.com/watch?v=dQw4w9WgXcQ or dQw4w9WgXcQ"
  3. Update the helper text to explain both formats are accepted
  4. Add a utility function `extractYouTubeVideoId(input)` that:
     - If input looks like a full URL (contains 'youtube.com' or 'youtu.be'), extracts the video ID
     - Handles youtube.com/watch?v=ID format
     - Handles youtu.be/ID format
     - Handles youtube.com/embed/ID format
     - If input is already just an ID (alphanumeric, 11 chars), returns as-is
  5. In handleChange for youtube_video_id, call extractYouTubeVideoId before storing
  6. Display the extracted ID in a helper text below the input when URL is pasted
  </action>
  <verify>Admin can paste full YouTube URL or just video ID. The stored value is always the extracted ID.</verify>
  <done>YouTube video field accepts full URLs and extracts ID automatically</done>
</task>

<task type="auto">
  <name>Task 2: Simplify Instagram widget options</name>
  <files>src/components/admin/AboutEditor.jsx, src/components/InstagramFeed.jsx</files>
  <action>
  1. In AboutEditor.jsx, update the Widget Type dropdown options:
     - Keep "None (link only)" as value "none"
     - Remove "LightWidget (third-party)" option
     - Keep "Official Embed" as value "official" but rename to "Custom Embed Code"
  2. Update the textarea placeholder for widget code:
     - Change to "Paste any Instagram embed/widget HTML code"
  3. In InstagramFeed.jsx:
     - Remove any special handling for 'lightwidget' type
     - Treat any non-'none' widget type the same (show embed code if provided)
  4. This simplifies from 3 options to 2: no widget, or custom embed code
  </action>
  <verify>Widget Type dropdown shows only "None (link only)" and "Custom Embed Code". Both work correctly.</verify>
  <done>Instagram widget options simplified to none or custom embed</done>
</task>

<task type="auto">
  <name>Task 3: Add dynamic social media links with database migration</name>
  <files>supabase/migrations/015_social_links_and_youtube_url.sql, src/components/admin/AboutEditor.jsx, src/pages/AboutPage.jsx</files>
  <action>
  1. Create migration 015_social_links_and_youtube_url.sql:
     - Add `social_links JSONB DEFAULT '[]'::jsonb` column to about_content
     - JSONB will store array of objects: [{platform: 'tiktok', url: 'https://...', label: 'TikTok'}, ...]

  2. In AboutEditor.jsx, add a Social Links section:
     - Keep existing YouTube and Instagram URL fields (these are primary)
     - Add "Additional Social Links" section below
     - Provide interface to add/remove social links with:
       - Platform dropdown (TikTok, Twitter/X, Facebook, Website, Other)
       - URL input field
       - Custom label input (defaults to platform name)
       - Delete button for each link
     - Store in content.social_links array

  3. In AboutPage.jsx, update "Connect With Me" section:
     - Keep hardcoded YouTube and Instagram buttons (they have special styling)
     - Map over content.social_links to render additional buttons
     - Use appropriate icons from lucide-react based on platform:
       - TikTok → Music2 icon (no official TikTok icon in lucide)
       - Twitter/X → Twitter icon
       - Facebook → Facebook icon
       - Website → Globe icon
       - Other → Link icon
     - Style additional buttons with a generic gray/blue theme
  </action>
  <verify>Admin can add/remove social links. Additional platforms show on About page with icons.</verify>
  <done>Dynamic social media links with database support and UI</done>
</task>

<task type="auto">
  <name>Task 4: Fix location count display bug</name>
  <files>src/pages/AboutPage.jsx, src/services/locationService.js</files>
  <action>
  1. Review current AboutPage.jsx stats section (lines 116-149):
     - Currently: `content?.location_count ? content.location_count.toLocaleString() + '+' : '600+'`
     - Bug: When location_count is 0, it shows '600+' instead of '0+'

  2. Fix the location count check:
     - Change from truthy check to null/undefined check
     - Use: `content?.location_count != null ? content.location_count.toLocaleString() + '+' : '600+'`
     - This ensures 0 is displayed correctly if set

  3. Apply same fix to country_count and video_count:
     - `content?.country_count != null ? ... : '--'`
     - `content?.video_count != null ? ... : '--'`

  4. Consider: Should we auto-fetch from DB when admin value is null?
     - Current design: admin manually sets or leaves blank for default
     - Enhancement (optional): fetch live count from locationService when null
     - Keep current design for now (manual entry with DB hints in admin)
  </action>
  <verify>Setting location_count to 0 in admin displays "0+" on About page, not "600+"</verify>
  <done>Stats display correctly handles zero and null values</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] YouTube video field accepts full URLs and extracts video ID
- [ ] Instagram widget has only 2 options: none or custom embed
- [ ] Admin can add/remove additional social links
- [ ] Additional social links display on About page with icons
- [ ] Location count of 0 displays correctly (not falling back to default)
- [ ] npm run build succeeds
- [ ] Run migration 015 on local database
</verification>

<success_criteria>
- All 4 tasks completed
- Full YouTube URL support working
- Instagram widget simplified
- Dynamic social links functional
- Stats display bug fixed
</success_criteria>

<output>
After completion, create `.planning/phases/21-social-media-about-improvements/21-01-SUMMARY.md`
</output>
