---
phase: 02-component-decomposition
plan: 04
type: execute
wave: 2
depends_on: ["02-02"]
files_modified: [src/pages/SuggestPage.jsx]
autonomous: true
---

<objective>
Refactor SuggestPage to use the extracted AuthPrompt component and URL parsing utility.

Purpose: Reduce SuggestPage from 218 lines to under 150 by using extracted pieces.
Output: Simplified SuggestPage that imports from new modules.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@.planning/phases/02-component-decomposition/02-02-SUMMARY.md

@src/pages/SuggestPage.jsx
@src/components/AuthPrompt.jsx
@src/utils/parseGoogleMapsUrl.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Refactor SuggestPage to use extracted modules</name>
  <files>src/pages/SuggestPage.jsx</files>
  <action>
    Rewrite SuggestPage to import and use the extracted pieces:

    1. Import new modules:
       ```js
       import AuthPrompt from '../components/AuthPrompt';
       import { parseGoogleMapsUrl } from '../utils/parseGoogleMapsUrl';
       ```

    2. Remove AuthModal import (now handled by AuthPrompt internally)

    3. Remove showAuthModal state (now handled by AuthPrompt internally)

    4. Replace the "not logged in" block (lines 79-105) with:
       ```jsx
       if (!user) {
         return (
           <div className="flex-1 flex items-center justify-center bg-background p-4">
             <AuthPrompt
               message="You need to be signed in to suggest locations. This helps us prevent spam and keep suggestions organized."
             />
           </div>
         );
       }
       ```

    5. Update handleGoogleMapsLinkChange to use utility:
       ```js
       const handleGoogleMapsLinkChange = (e) => {
         const url = e.target.value;
         setGoogleMapsLink(url);
         if (url) {
           const name = parseGoogleMapsUrl(url);
           if (name) setLocationName(name);
         }
       };
       ```

    6. Remove the extractLocationFromUrl function (now using imported utility)

    7. Remove User icon import if no longer needed directly
  </action>
  <verify>npm run dev - SuggestPage renders correctly for both logged-in and logged-out states</verify>
  <done>SuggestPage refactored to use extracted modules</done>
</task>

<task type="auto">
  <name>Task 2: Verify SuggestPage line count</name>
  <files>src/pages/SuggestPage.jsx</files>
  <action>
    Count lines in refactored SuggestPage.

    Target: Under 150 lines.

    Current: 218 lines. Expected reduction: ~50 lines from AuthPrompt + URL parsing extraction.

    If still over 150 lines, consider:
    - Extract the form into a SuggestForm component
    - Extract the header into a PageHeader component

    Make additional extractions if needed to hit target.
  </action>
  <verify>wc -l src/pages/SuggestPage.jsx shows under 150</verify>
  <done>SuggestPage is under 150 lines</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] npm run dev works without errors
- [ ] Suggest page shows auth prompt when logged out
- [ ] Auth modal opens from prompt
- [ ] Suggest form works when logged in
- [ ] Google Maps URL auto-fills location name
- [ ] Form submission works
- [ ] SuggestPage.jsx is under 150 lines
</verification>

<success_criteria>
- SuggestPage refactored to use extracted modules
- Line count under 150
- All functionality preserved
</success_criteria>

<output>
After completion, create `.planning/phases/02-component-decomposition/02-04-SUMMARY.md`
</output>
